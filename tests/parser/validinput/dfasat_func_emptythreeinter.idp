include<mx>


vocabulary V { 
  type State isa int
  type Label isa int
  type Color isa int
  // Trans sends a state and a label to the result of 
  // choosing label in that state
  partial Trans(State, Label) : State
  Acc(State)
  Rej(State)
  // Represents the resulting automaton. 
  partial CTrans(Color, Label) : Color
  AccColor(Color)
 // Used(Color)
  ColorOf(State) : Color
}



procedure idp_T1_withsymm_nobounds_noCP(groundonly){
	stdoptions.symmetrybreaking="static"
	stdoptions.groundwithbounds=false
	stdoptions.liftedunitpropagation=false
	stdoptions.cpsupport=false
	run(T1, groundonly);
}

procedure idp_T1_nosymm_withbounds_noCP(groundonly){
	stdoptions.symmetrybreaking="none"
	stdoptions.groundwithbounds=true
	stdoptions.liftedunitpropagation=true
	stdoptions.cpsupport=false
	run(T1, groundonly);
}

procedure idp_T1_withsymm_withbounds_withCP(groundonly){
	stdoptions.symmetrybreaking="static"
	stdoptions.groundwithbounds=true
	stdoptions.liftedunitpropagation=true
	stdoptions.cpsupport=true
	run(T1, groundonly);
}

procedure idp_T1_withsymm_withbounds_noCP(groundonly){
	stdoptions.symmetrybreaking="static"
	stdoptions.groundwithbounds=true
	stdoptions.liftedunitpropagation=true
	stdoptions.cpsupport=false
	run(T1, groundonly);
}

procedure idp_T1_nosymm_GOODbounds_noCP(groundonly){
	stdoptions.symmetrybreaking="none"
	stdoptions.groundwithbounds=true
	stdoptions.liftedunitpropagation=true
	stdoptions.nrpropsteps=10
	stdoptions.longestbranch=14
	stdoptions.cpsupport=false
	run(T1, groundonly);
}


procedure idp_TNoRed_nosymm_withbounds_noCP(groundonly){
	stdoptions.symmetrybreaking="none"
	stdoptions.groundwithbounds=true
	stdoptions.liftedunitpropagation=true
	stdoptions.cpsupport=false
	run(TNoRed, groundonly);
}

procedure run(theo, groundonly){
	stdoptions.timeout = 5000
	stdoptions.nbmodels = 1
	if groundonly then
		stdoptions.language="ecnf"
		printgrounding(theo,S)
	else
		print(modelexpand(theo,S)[1])
	end
}

theory T1 : V {
  !x[State]: Acc(x) => AccColor(ColorOf(x)).
  !x[State]: Rej(x) => ~AccColor(ColorOf(x)).

  // trans induces CTrans:
  ! v[State] a[Label] w[State] : Trans(v,a)=w => CTrans(ColorOf(v),a)=ColorOf(w).

  // redundante constraint;
  !v[State] l[Label] w[State] j[Color] :  Trans(w,l)=v &  CTrans(ColorOf(w),l)=j => ColorOf(v)=j.
  
  //EXTRA REDUNDANTE CONSTRAINT. NIET IN SAT ENCODING
//   !v l w i : trans(w,l)=v &  CTrans(i,l)=colorOf(v) => colorOf(w)=i.

  // determinisation conflicts
  //!x y: Incompatible(x,y) => ColorOf(x) ~= ColorOf(y).
  //Could this be something like Trans(v,a) = w & Acc(v) & Rej(w) => ...???
  
  //Use the cliques -> PRESENT IN STRUCTURE
}

theory TNoRed : V {
  !x[State]: Acc(x) => AccColor(ColorOf(x)).
  !x[State]: Rej(x) => ~AccColor(ColorOf(x)).

  // trans induces CTrans:
  ! v[State] a[Label] w[State] : Trans(v,a)=w => CTrans(ColorOf(v),a)=ColorOf(w).
  
  //EXTRA REDUNDANTE CONSTRAINT. NIET IN SAT ENCODING
//   !v l w i : trans(w,l)=v &  CTrans(i,l)=colorOf(v) => colorOf(w)=i.
}

structure S : V {
  Color = {0..0}
  State = {0..512}
  Label = {1..2}
  Trans = {0,1->2;0,2->1;1,1->3;1,2->11;2,1->4;2,2->5;3,1->10;3,2->6;4,1->8;4,2->20;5,1->32;5,2->12;6,1->7;7,1->13;7,2->48;8,2->9;9,1->14;9,2->125;10,1->38;10,2->15;11,1->29;11,2->24;12,1->21;12,2->36;13,1->113;13,2->17;14,1->28;14,2->66;15,1->16;16,1->47;16,2->76;17,1->18;18,2->19;19,1->23;20,1->42;20,2->87;21,2->22;22,1->25;23,2->26;24,1->147;24,2->40;25,1->99;25,2->101;26,1->27;27,1->77;27,2->144;28,1->64;28,2->179;29,1->30;30,2->31;31,1->33;32,1->34;33,2->39;34,1->35;35,1->43;36,1->37;37,2->44;38,1->45;39,1->49;40,1->41;41,1->50;42,1->51;43,2->52;44,1->54;45,2->46;46,1->55;47,1->57;48,1->59;49,1->60;50,2->62;51,1->67;52,1->53;53,2->69;54,1->70;55,1->56;56,2->72;57,2->58;58,2->74;59,2->78;60,2->61;61,1->80;62,1->63;63,2->82;64,2->65;65,1->83;66,1->85;67,1->68;68,1->86;69,2->97;70,1->71;71,1->106;72,1->73;73,2->107;74,2->75;75,2->108;76,1->112;77,2->115;78,1->79;79,2->117;80,1->81;81,2->118;82,2->120;83,1->84;84,1->122;85,1->123;86,2->129;87,1->88;88,2->89;89,2->90;90,1->91;91,2->92;92,2->93;93,1->94;94,2->95;95,1->96;96,1->130;97,1->98;98,2->131;99,1->100;100,2->132;101,2->102;102,1->103;103,2->104;104,1->105;105,2->135;106,1->136;107,1->138;108,2->109;109,2->110;110,2->111;111,1->139;112,2->140;113,1->114;114,1->142;115,1->116;116,2->143;117,1->145;118,1->119;119,2->146;120,1->121;121,2->149;122,2->150;123,2->124;124,2->152;125,1->126;126,2->127;127,1->128;128,1->154;129,2->155;130,1->157;131,1->159;132,1->133;133,2->134;134,2->160;135,1->161;136,2->137;137,1->162;138,2->163;139,1->166;140,1->141;141,2->168;142,1->169;143,1->171;144,1->172;145,2->173;146,1->175;147,2->148;148,2->176;149,1->177;150,1->151;151,2->178;152,2->153;153,2->182;154,1->188;155,1->156;156,1->190;157,1->158;158,1->191;159,1->192;160,2->194;161,2->196;162,2->199;163,2->164;164,2->165;165,1->200;166,2->167;167,2->201;168,2->203;169,2->170;170,1->206;171,2->207;172,1->209;173,1->174;174,1->211;175,2->212;176,1->214;177,1->215;178,2->217;179,2->180;180,2->181;181,1->222;182,2->183;183,2->184;184,1->185;185,2->186;186,1->187;187,1->223;188,1->189;189,1->224;190,2->225;191,2->228;192,2->193;193,1->229;194,1->195;195,2->231;196,2->197;197,2->198;198,2->232;199,2->233;200,1->235;201,2->202;202,1->237;203,2->204;204,2->205;205,2->238;206,2->239;207,1->208;208,2->240;209,1->210;210,1->241;211,1->242;212,1->213;213,2->244;214,2->245;215,1->216;216,2->248;217,2->218;218,1->219;219,2->220;220,1->221;221,2->251;222,1->252;223,1->254;224,1->256;225,2->226;226,2->227;227,2->258;228,2->259;229,2->230;230,1->261;231,2->262;232,2->264;233,1->234;234,2->267;235,1->236;236,1->268;237,2->269;238,1->270;239,1->271;240,1->272;241,2->273;242,1->243;243,1->274;244,1->275;245,2->246;246,2->247;247,1->276;248,1->249;249,2->250;250,1->277;251,2->278;252,1->253;253,2->280;254,2->255;255,1->284;256,1->257;257,1->286;258,1->287;259,1->260;260,2->288;261,1->289;262,1->263;263,2->291;264,2->265;265,2->266;266,1->292;267,2->293;268,2->296;269,1->297;270,1->298;271,2->300;272,2->307;273,1->309;274,1->310;275,2->312;276,2->314;277,2->316;278,1->279;279,2->319;280,2->281;281,2->282;282,2->283;283,2->320;284,2->285;285,1->321;286,2->322;287,2->324;288,1->327;289,1->290;290,1->328;291,1->329;292,1->330;293,2->294;294,2->295;295,2->332;296,2->333;297,1->335;298,1->299;299,2->337;300,2->301;301,1->302;302,1->303;303,1->304;304,2->305;305,1->306;306,2->342;307,1->308;308,2->343;309,1->344;310,1->311;311,1->346;312,1->313;313,1->347;314,1->315;315,2->348;316,2->317;317,2->318;318,2->349;319,1->350;320,1->351;321,1->352;322,1->323;323,1->354;324,2->325;325,2->326;326,2->355;327,2->356;328,1->358;329,1->359;330,2->331;331,2->361;332,2->363;333,1->334;334,1->365;335,1->336;336,1->366;337,1->338;338,1->339;339,2->340;340,1->341;341,1->367;342,1->368;343,1->369;344,2->345;345,2->370;346,1->372;347,2->373;348,1->375;349,2->376;350,2->378;351,2->380;352,2->353;353,1->387;354,1->388;355,1->390;356,1->357;357,1->391;358,2->392;359,2->360;360,1->394;361,1->362;362,1->396;363,1->364;364,1->397;365,1->398;366,2->400;367,1->401;368,1->403;369,2->405;370,2->371;371,2->407;372,1->412;373,1->374;374,2->414;375,1->415;376,1->377;377,2->417;378,1->379;379,1->418;380,2->381;381,1->382;382,1->383;383,1->384;384,1->385;385,2->386;386,2->419;387,2->420;388,1->389;389,2->421;390,2->429;391,2->434;392,1->393;393,1->437;394,1->395;395,2->438;396,1->443;397,2->444;398,1->399;399,2->447;400,2->450;401,1->402;402,2->452;403,1->404;404,2->455;405,1->406;406,1->458;407,1->408;408,1->409;409,2->410;410,1->411;411,2->459;412,2->413;413,1->460;414,1->462;415,2->416;416,2->463;417,2->465;418,2->467;419,2->469;420,1->472;421,1->422;422,1->423;423,2->424;424,2->425;425,1->426;426,1->427;427,2->428;428,1->473;429,2->430;430,1->431;431,2->432;432,1->433;433,1->474;434,2->435;435,2->436;436,2->475;437,1->476;438,2->439;439,1->440;440,2->441;441,1->442;442,2->478;443,2->479;444,2->445;445,2->446;446,1->481;447,2->448;448,1->449;449,2->482;450,1->451;451,2->483;452,2->453;453,1->454;454,2->484;455,1->456;456,2->457;457,1->485;458,1->486;459,1->488;460,1->461;461,1->489;462,2->490;463,2->464;464,2->492;465,1->466;466,2->502;467,1->468;469,2->470;470,2->471;472,2->503;474,1->504;476,1->477;477,2->505;479,1->480;481,2->507;485,2->508;486,1->487;489,2->509;490,1->491;492,2->493;493,2->494;494,1->495;495,1->496;496,1->497;497,1->498;498,1->499;499,2->500;500,1->501;505,1->506;509,2->510;510,1->511;511,1->512;}
  Acc = {0;3;4;5;7;8;10;11;13;14;16;18;19;22;23;25;27;28;29;31;32;33;35;37;38;39;41;42;43;44;46;47;48;49;50;51;53;54;56;58;59;61;63;65;66;68;69;71;73;75;76;77;79;81;82;84;85;86;96;98;100;105;106;107;111;112;114;116;117;119;121;122;124;128;129;130;131;134;135;137;138;139;141;142;143;144;145;146;148;149;151;153;154;156;158;159;160;161;162;165;167;168;170;171;172;174;175;176;177;178;181;187;189;190;191;193;195;198;199;200;202;205;206;208;210;211;213;214;216;221;222;223;224;227;228;230;231;232;234;236;237;238;239;240;241;243;244;247;250;251;253;255;257;258;260;261;263;266;267;268;269;270;271;272;273;274;275;276;277;279;283;285;286;287;288;290;291;292;295;296;297;299;306;308;309;311;313;315;318;319;320;321;323;326;327;328;329;331;332;334;336;341;342;343;345;346;347;348;349;350;351;353;354;355;357;358;360;362;364;365;366;367;368;369;371;372;374;375;377;379;386;387;389;390;391;393;395;396;397;399;400;402;404;406;411;413;414;416;417;418;419;420;428;433;436;437;442;443;446;449;451;454;457;458;459;461;462;464;466;468;471;472;473;474;475;477;478;480;481;482;483;484;485;487;488;489;491;501;502;}
  Rej = {1;2;6;9;12;15;17;20;21;24;26;30;34;36;40;45;52;55;57;60;62;64;67;70;72;74;78;80;83;87;88;89;90;91;92;93;94;95;97;99;101;102;103;104;108;109;110;113;115;118;120;123;125;126;127;132;133;136;140;147;150;152;155;157;163;164;166;169;173;179;180;182;183;184;185;186;188;192;194;196;197;201;203;204;207;209;212;215;217;218;219;220;225;226;229;233;235;242;245;246;248;249;252;254;256;259;262;264;265;278;280;281;282;284;289;293;294;298;300;301;302;303;304;305;307;310;312;314;316;317;322;324;325;330;333;335;337;338;339;340;344;352;356;359;361;363;370;373;376;378;380;381;382;383;384;385;388;392;394;398;401;403;405;407;408;409;410;412;415;421;422;423;424;425;426;427;429;430;431;432;434;435;438;439;440;441;444;445;447;448;450;452;453;455;456;460;463;465;467;469;470;476;479;486;490;492;493;494;495;496;497;498;499;500;503;504;505;506;507;508;509;510;511;512;}
  ColorOf<ct> = {0->0;}
  CTrans<ct> = {} //THIS IS THE IMPORTANT CHECK!
  AccColor<ct> = {0;}
  AccColor<cf> = {}
}
procedure main(){
  return 1
}

